<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>AJAX | Smallvica</title>
  
  
  
  <!--link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css"-->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
<div class="Shell">
    <aside class='SideBar'>
    <section class='avatar' style="background-image: url()">
        <div class='av-pic' style="background-image: url(https://i.loli.net/2018/08/22/5b7d27799463d.jpg)">
        </div>
    </section>
    <section class='menu'>
        <div>Smallvica</div>
        
        <ul>
          
            <a href="/" class="Btn">
              <li>Home</li>
            </a>  
          
            <a href="/archives/" class="Btn">
              <li>Archive</li>
            </a>  
          
        </ul>
    </section>
    <section class="media">
        
    </section>
</aside>

    <div class="container">
        <div data-pager-shell>
            <div>
  <article class='ContentView'>
    <header class='PageTitle'>
        <h1>AJAX</h1>
    </header>

    <section>
      <blockquote>
<p>AJAX—异步的JavaScript与XML技术<br><img src="https://i.loli.net/2018/08/22/5b7d3911bdf47.jpg" alt="4-min.jpg"></p>
</blockquote>
<h1 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h1><p>维基百科<br>AJAX即“Asynchronous JavaScript and XML”（异步的JavaScript与XML技术），指的是一套综合了多项技术的浏览器端网页开发技术。Ajax的概念由杰西·詹姆士·贾瑞特所提出。<br>传统的Web应用允许用户端填写表单（form），当提交表单时就向网页服务器发送一个请求。服务器接收并处理传来的表单，然后送回一个新的网页，但这个做法浪费了许多带宽，因为在前后两个页面中的大部分HTML码往往是相同的。由于每次应用的沟通都需要向服务器发送请求，应用的回应时间依赖于服务器的回应时间。这导致了用户界面的回应比本机应用慢得多。<br>与此不同，AJAX应用可以仅向服务器发送并取回必须的数据，并在客户端采用JavaScript处理来自服务器的回应。因为在服务器和浏览器之间交换的数据大量减少，服务器回应更快了。同时，很多的处理工作可以在发出请求的客户端机器上完成，因此Web服务器的负荷也减少了。<br>类似于DHTML或LAMP，AJAX不是指一种单一的技术，而是有机地利用了一系列相关的技术。虽然其名称包含XML，但实际上数据格式可以由JSON代替，进一步减少数据量，形成所谓的AJAJ。而客户端与服务器也并不需要异步。一些基于AJAX的“派生／合成”式（derivative/composite）的技术也正在出现，如AFLAX。</p>
<h1 id="2-演变"><a href="#2-演变" class="headerlink" title="2.演变"></a>2.演变</h1><h1 id="2-1-如何发送请求？"><a href="#2-1-如何发送请求？" class="headerlink" title="2.1 如何发送请求？"></a>2.1 如何发送请求？</h1><p>最初的具有局限性的发送请求的几种方式：</p>
<ul>
<li>用 form 可以发请求，但是会刷新页面或新开页面</li>
<li>用 a 可以发 get 请求，但是也会刷新页面或新开页面</li>
<li>用 img 可以发 get 请求，但是只能以图片的形式展示</li>
<li>用 link 可以发 get 请求，但是只能以 CSS、favicon 的形式展示</li>
<li>用 script 可以发 get 请求，但是只能以脚本的形式运行<br>局限性在于刷新页面，占用内存资源，带宽浪费，如果我想事项以下两个条件：</li>
</ul>
<ol>
<li>get、post、put、delete 请求都行</li>
<li>形式不定，即想以什么形式展示就以什么形式展示<h1 id="2-2-新突破"><a href="#2-2-新突破" class="headerlink" title="2.2 新突破"></a>2.2 新突破</h1>IE 5 率先在 JS 中引入 ActiveX 对象（API），使得 JS 可以直接发起 HTTP 请求。<br>随后 Mozilla、 Safari、 Opera 也跟进（抄袭）了，取名 XMLHttpRequest，并被纳入 W3C 规范。<h1 id="2-3规范化"><a href="#2-3规范化" class="headerlink" title="2.3规范化"></a>2.3规范化</h1>Jesse James Garrett将这个技术取名为AJAX：异步的JavaScript和XML。</li>
<li>创建 AJAX 对象, 即 XMLHttpRequest</li>
<li>使用XMLHttpRequest发请求</li>
<li>服务器返回XML格式的字符串，只能返回字符串</li>
<li>JS解析XML，并更新局部页面<h1 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h1><h2 id="原生JS写一个AJAX请求"><a href="#原生JS写一个AJAX请求" class="headerlink" title="原生JS写一个AJAX请求"></a>原生JS写一个AJAX请求</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let request = new XMLHttpRequest(); </span><br><span class="line">request.open(&apos;GET&apos;,&apos;/xxx&apos;); </span><br><span class="line">request.send();</span><br><span class="line">request.onreadystatechange = ()=&gt;&#123;</span><br><span class="line">  if(request.readyState === 4)&#123;</span><br><span class="line">    if(request.status &gt;= 200 &amp;&amp; request.status &lt; 300)&#123;</span><br><span class="line">      var string = request.responseText;</span><br><span class="line">      var value = JSON.parse(string);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li><p>let request = new XMLHttpRequest() 创建一个AJAX实例</p>
</li>
<li><p>request.open(method,address) 初始化请求，一般有3个参数 ，如果没有设置就是 默认值<br>request.open(method,url,async)<br>method ：请求的类型；GET 或 POST<br>url ： 文件在服务器上的位置<br>async ：true（异步）或 false（同步）</p>
</li>
<li><p>request.send() 发送请求(如果参数为String，只能为 post请求)</p>
</li>
<li><p>reqeust.onreadystatechange() 监听 readystatue 的变化 ，每当 readyState 改变时，就会触发 onreadystatechange 事件。</p>
</li>
<li><p>request.readyState XMLHttpRequest 的状态。从 0 到 4 发生变化<br>| 0 | UNSENT(未打开) | open()方法还未被调用，请求未初始化 |<br>| 1 | OPENED (未发送) | open()方法已经被调用， 服务器连接已建立 |<br>| 2 | HEADERS_RECEIVED (已获取响应头) | send()方法已经被调用, 响应头和响应状态已经返回.请求已接收 |<br>| 3 | LOADING (正在下载响应体) | 响应体下载中; responseText中已经获取了部分数据. |<br>| 4 | DONE (请求完成) | 整个请求过程已经完毕. |</p>
<h1 id="同源策略"><a href="#同源策略" class="headerlink" title="同源策略"></a>同源策略</h1></li>
<li>form、img、script等上面提到的请求方式，是可以对别的域名发送请求的。<br>但用AJAX不能对别的域名放送请求，只有协议、域名、端口号一摸一样才允许发送AJAX（多个www是不同的域名）<br>因为AJAX是可以获取响应内容的，如果没有同源策略的限制，别的网站可以通过AJAX获取另一个网站的所有信息。</li>
<li>AJAX可以通过CORS发送请求到别的网站<br>跨域资源共享：Cross-Origin Resource Sharing<br>在需要访问的服务器里添加一句<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(&apos;Access-Control-Allow-Origin&apos;, &apos;*&apos;)</span><br></pre></td></tr></table></figure>
</li>
</ul>


      

    </section>
    
      <section class='ArticleMeta'>
          <div>
            发布于&nbsp;
            <time datetime="2018-08-22T01:33:43.000Z" itemprop="datePublished">
              2018-08-22
            </time>
          </div>
          
      </section>
    
    
</article>

  
</div>

            <footer>
    <div>© 2018 - Chen Zhe </div>
    <div>
        <span>
            Powered by <a href="https://hexo.io">Hexo</a>
        </span>
        ,
        <span>
            Theme - <a href="https://github.com/nameoverflow/hexo-theme-icalm">Icalm</a>
        </span>
    </div>
</footer>

        </div>
    </div>
</div>
<script src="/js/pager/dist/singlepager.js"></script>
<script>
var sp = new Pager('data-pager-shell')

</script>
</body>
</html>